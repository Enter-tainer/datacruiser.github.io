<!DOCTYPE html>




<html class="theme-next muse" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="加密算法,比特币,go语言," />





  <link rel="alternate" href="/atom.xml" title="Datacruiser's Blog" type="application/atom+xml" />






<meta name="description" content="学习区块链，总是无法避开各种加密算法，因为各种加密算法在实现区块链当中的各个环节都有着不可替代的作用。这里介绍一下在比特币挖矿以及merkle树当中被大量使用的鼎鼎大名的SHA256算法。">
<meta name="keywords" content="加密算法,比特币,go语言">
<meta property="og:type" content="article">
<meta property="og:title" content="SHA256算法原理及其实现">
<meta property="og:url" content="http://datacruiser.io/2019/11/22/SHA256算法原理及其实现/index.html">
<meta property="og:site_name" content="Datacruiser&#39;s Blog">
<meta property="og:description" content="学习区块链，总是无法避开各种加密算法，因为各种加密算法在实现区块链当中的各个环节都有着不可替代的作用。这里介绍一下在比特币挖矿以及merkle树当中被大量使用的鼎鼎大名的SHA256算法。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://machinelearning-1255641038.cos.ap-chengdu.myqcloud.com/Datacruiser_Blog_Sources/SHA/yarbrelease.dvi%202019-12-01%2017-50-06.png">
<meta property="og:image" content="https://machinelearning-1255641038.cos.ap-chengdu.myqcloud.com/Datacruiser_Blog_Sources/SHA/yarbrelease.dvi%202019-12-01%2017-50-41.png">
<meta property="og:updated_time" content="2020-01-31T14:37:28.388Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SHA256算法原理及其实现">
<meta name="twitter:description" content="学习区块链，总是无法避开各种加密算法，因为各种加密算法在实现区块链当中的各个环节都有着不可替代的作用。这里介绍一下在比特币挖矿以及merkle树当中被大量使用的鼎鼎大名的SHA256算法。">
<meta name="twitter:image" content="https://machinelearning-1255641038.cos.ap-chengdu.myqcloud.com/Datacruiser_Blog_Sources/SHA/yarbrelease.dvi%202019-12-01%2017-50-06.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://datacruiser.io/2019/11/22/SHA256算法原理及其实现/"/>





  <title>SHA256算法原理及其实现 | Datacruiser's Blog</title>
  <style>
  .forkme{
    display: none;
  }
  @media (min-width: 768px) {
  .forkme{
    display: inline;
  }
  }
  </style><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <div class="forkme">
  <a href="https://github.com/datacruiser" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
  <style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </div>  

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Datacruiser's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">数海拾荒</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://datacruiser.io/2019/11/22/SHA256算法原理及其实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Datacruiser">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://i.imgur.com/qsQpBoA.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Datacruiser's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">SHA256算法原理及其实现</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-22T20:25:25+00:00">
                2019-11-22
              </time>
            

            

            
          </span>

          
             <span class="post-updated">
                &nbsp; | &nbsp; 更新于
            <time itemprop="dateUpdated" datetime="2020-01-31T14:37:28+00:00" content="2020-01-31">
                2020-01-31
             </time>
             </span>
         

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/区块链/" itemprop="url" rel="index">
                    <span itemprop="name">区块链</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/11/22/SHA256算法原理及其实现/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/11/22/SHA256算法原理及其实现/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> 浏览
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3.2k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  15
                </span>
              
            </div>
          

          
              <div class="post-description">
                  学习区块链，总是无法避开各种加密算法，因为各种加密算法在实现区块链当中的各个环节都有着不可替代的作用。这里介绍一下在比特币挖矿以及merkle树当中被大量使用的鼎鼎大名的SHA256算法。
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="SHA-2-族算法简介"><a href="#SHA-2-族算法简介" class="headerlink" title="SHA-2 族算法简介"></a>SHA-2 族算法简介</h1><p>一个<code>n</code>位的哈希函数就是一个从任意长的消息到<code>n</code>位哈希值的映射，一个<code>n</code>位的加密哈希函数就是一个单向的、避免碰撞的<code>n</code>位哈希函数。这样的函数是目前在数字签名和密码保护当中极为重要的手段。</p>
<p>当前比较流行的哈希函数主要有128位的MD4和MD5和160位的SHA-1，今天介绍的SHA-2族有着更多位的输出哈希值，破解难度更大，能够提高更高的安全性。</p>
<p>SHA-2，名称来自于安全散列算法2（英语：Secure Hash Algorithm 2）的缩写，一种<a href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A2%BC%E9%9B%9C%E6%B9%8A%E5%87%BD%E6%95%B8" target="_blank" rel="noopener">密码散列函数</a>算法标准，由<a href="https://zh.wikipedia.org/wiki/%E7%BE%8E%E5%9B%BD%E5%9B%BD%E5%AE%B6%E5%AE%89%E5%85%A8%E5%B1%80" target="_blank" rel="noopener">美国国家安全局</a>研发，由<a href="https://zh.wikipedia.org/wiki/%E5%9C%8B%E5%AE%B6%E6%A8%99%E6%BA%96%E6%8A%80%E8%A1%93%E7%A0%94%E7%A9%B6%E6%89%80" target="_blank" rel="noopener">美国国家标准与技术研究院</a>（NIST）在2001年发布。属于<a href="https://zh.wikipedia.org/wiki/SHA%E5%AE%B6%E6%97%8F" target="_blank" rel="noopener">SHA算法</a>之一，是SHA-1的后继者。其下又可再分为六个不同的算法标准，包括了：SHA-224、SHA-256、SHA-384、SHA-512、SHA-512/224、SHA-512/256。</p>
<p>这些变体除了生成摘要的长度、循环运行的次数等一些细微差异之外，基本结构是一致的。本文主要讲一讲SHA256。</p>
<h1 id="SHA256原理详解"><a href="#SHA256原理详解" class="headerlink" title="SHA256原理详解"></a>SHA256原理详解</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>对于任意长度的消息，SHA256都会产生一个256位的哈希值，称作消息摘要。这个摘要相当于四个长度为32个字节的数组，通常有一个长度为64的十六进制字符串来表示，其中1个字节=8位，一个十六进制的字符的长度为4位。</p>
<p>来看一个具体的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BlockChain</span><br></pre></td></tr></table></figure>
<p>这句话经过哈希函数SHA256后得到的哈希值为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3a6fed5fc11392b3ee9f81caf017b48640d7458766a8eb0382899a605b41f2b9</span><br></pre></td></tr></table></figure>
<p>总体上，HSA256与MD4、MD5以及HSA-1等哈希函数的操作流程类似，待哈希的消息在继续哈希计算之前首先要进行以下两个步骤：</p>
<ul>
<li>对消息进行补位处理，是的最终的长度是512位的倍数，然后</li>
<li>以512位为单位对消息进行分块为$M^{(1)},\,M^{(2)},…,M^{(N)}$</li>
</ul>
<p>消息区块将进行逐个处理：从一个固定的初始哈希$H^{(0)}$开始，进行以下序列的计算：</p>
<p>$$H^{(i)}=H^{(i-1)}+C_{M^{(i)} }(H^{(i-1)})$$</p>
<p>其中$C$是SHA256的压缩函数，$+$是mod$2^{32}$加法，即将两个数字加在一起，如果对$2^{32}$取余, $H^{(N)}$是消息区块的哈希值. </p>
<h2 id="算法详细描述"><a href="#算法详细描述" class="headerlink" title="算法详细描述"></a>算法详细描述</h2><p>SHA256的压缩函数主要对512位的消息区块和256位的中间哈希值进行操作，本质上，它是一个通过将消息区块为密钥对中间哈希值进行加密的256位加密算法。<br>因此，为了描述SHA256算法，有以下两方面的组件需要描述：</p>
<ul>
<li>SHA256压缩函数</li>
<li>SHA256消息处理流程</li>
</ul>
<p>以下的描述当中所使用到的标记如下：</p>
<ul>
<li>$\oplus$: 按位异或</li>
<li>$\wedge$: 按位与</li>
<li>$\vee$: 按位或</li>
<li>$\lnot$: 补位</li>
<li>$+$: 相加以后对$2^{32}$求余</li>
<li>$R^n$: 右移n位</li>
<li>$S^n$: 循环右移n位</li>
</ul>
<p>以上所有的操作都是针对32位字节. </p>
<h3 id="常量初始化"><a href="#常量初始化" class="headerlink" title="常量初始化"></a>常量初始化</h3><p>初始哈希值$H^{(0)}$取自自然数中前面8个素数(2,3,5,7,11,13,17,19)的平方根的小数部分, 并且取前面的32位. 下面举个例子:<br>$\sqrt{2}$小数部分约为0.414213562373095048, 而其中<br>$$0.414213562373095048 \approx 6<em>16^{-1}+a</em>16^{-2}+0*16^{-3}+…$$<br>于是, 质数2的平方根的小数部分取前32位就对应<code>0x6a09e667</code>. </p>
<p>如此类推, 初始哈希值$H^{(0)}$由以下8个32位的哈希初值构成:</p>
<p>$$<br>\begin{align}<br>H^{(0)}_1&amp;=6a09e667\\<br>H^{(0)}_2&amp;=bb67ae85\\<br>H^{(0)}_3&amp;=3c6ef372\\<br>H^{(0)}_4&amp;=a54ff53a\\<br>H^{(0)}_5&amp;=510e527f\\<br>H^{(0)}_6&amp;=9b05688c\\<br>H^{(0)}_7&amp;=1f83d9ab\\<br>H^{(0)}_8&amp;=5be0cd19<br>\end{align}<br>$$</p>
<p>SHA256算法当中还使用到64个常数, 取自自然数中前面64个素数的立方根的小数部分的前32位, 如果用16进制表示, 则相应的常数序列如下: </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">428</span>a2f98 <span class="number">71374491</span> b5c0fbcf e9b5dba5</span><br><span class="line"><span class="number">3956</span>c25b <span class="number">59f</span>111f1 <span class="number">923f</span>82a4 ab1c5ed5</span><br><span class="line">d807aa98 <span class="number">12835</span>b01 <span class="number">243185</span>be <span class="number">550</span>c7dc3</span><br><span class="line"><span class="number">72</span>be5d74 <span class="number">80d</span>eb1fe <span class="number">9</span>bdc06a7 c19bf174</span><br><span class="line">e49b69c1 efbe4786 <span class="number">0f</span>c19dc6 <span class="number">240</span>ca1cc</span><br><span class="line"><span class="number">2d</span>e92c6f <span class="number">4</span>a7484aa <span class="number">5</span>cb0a9dc <span class="number">76f</span>988da</span><br><span class="line"><span class="number">983e5152</span> a831c66d b00327c8 bf597fc7</span><br><span class="line">c6e00bf3 d5a79147 <span class="number">06</span>ca6351 <span class="number">14292967</span></span><br><span class="line"><span class="number">27</span>b70a85 <span class="number">2e1</span>b2138 <span class="number">4d</span>2c6dfc <span class="number">53380d</span>13</span><br><span class="line"><span class="number">650</span>a7354 <span class="number">766</span>a0abb <span class="number">81</span>c2c92e <span class="number">92722</span>c85</span><br><span class="line">a2bfe8a1 a81a664b c24b8b70 c76c51a3</span><br><span class="line">d192e819 d6990624 f40e3585 <span class="number">106</span>aa070</span><br><span class="line"><span class="number">19</span>a4c116 <span class="number">1e376</span>c08 <span class="number">2748774</span>c <span class="number">34</span>b0bcb5</span><br><span class="line"><span class="number">391</span>c0cb3 <span class="number">4</span>ed8aa4a <span class="number">5</span>b9cca4f <span class="number">682e6f</span>f3</span><br><span class="line"><span class="number">748f</span>82ee <span class="number">78</span>a5636f <span class="number">84</span>c87814 <span class="number">8</span>cc70208</span><br><span class="line"><span class="number">90</span>befffa a4506ceb bef9a3f7 c67178f2</span><br></pre></td></tr></table></figure>
<h3 id="消息预处理"><a href="#消息预处理" class="headerlink" title="消息预处理"></a>消息预处理</h3><p>在计算消息的哈希摘要之前需要对消息进行预处理:</p>
<ul>
<li>对消息进行补码处理: 假设消息$M$的二进制编码长度为$l$位. 首先在消息末尾补上一位”1”, 然后再补上$k$个”0”, 其中$k$为下列方程的最小非负整数<br>$$l+1+k\equiv448 \mod 512$$</li>
</ul>
<p>举个例子, 以消息”abc”为例显示补位的过程. </p>
<p>a,b,c对应的<a href="http://ascii.911cha.com/" target="_blank" rel="noopener">ASCII码</a>和二进制编码分别如下:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">原始字符    ASCII码    二进制编码</span><br><span class="line">a          <span class="number">97</span>         <span class="number">01100001</span></span><br><span class="line">b          <span class="number">98</span>         <span class="number">01100010</span></span><br><span class="line">c          <span class="number">99</span>         <span class="number">01100011</span></span><br></pre></td></tr></table></figure>
<p>因此, 原始信息”abc”的二进制编码为:<code>01100001 01100010 01100011</code>, 第一步补位, 首先在消息末尾补上一位”1”, 结果为: <code>01100001 01100010 01100011 1</code>;<br>然后进行第二步的补位, 因为$l=24$, 可以得到$k=423$, 在第一步补位后的消息后面再补423个”0”, 结果如下:</p>
<p>$$01100001 \, 01100010 \, 01100011 \,1\, \underbrace{00…0}_{423}$$ </p>
<p>最后还需要在上述字节串后面继续进行补码, 这个时候补的是原消息”abc”的二进制长度$l=24$的64位二进制表示形式, 补完以后的结果如下:</p>
<p>$$01100001 \, 01100010 \, 01100011 \,1\, \underbrace{00…0}_{423}\,\underbrace{00…011000}_{64}$$ </p>
<p>最终补完以后的消息二进制位数长度是512的倍数. </p>
<p>这里需要注意的两点是不管原来的消息长度是多少, 即使长度已经满足对512取模后余数是448，补位也必须要进行，这时要填充512位. 另外, 考虑到最后要将消息长度$l$转换为64位二进制编码, 因此, 长度的必须小于$2^{64}$, 绝大多数情况, 这个足够大了. </p>
<ul>
<li>将补码处理后的消息以512位为单位分块为: $M^{(1)},\,M^{(2)},…,M^{(N)}$, 其中第$i$个消息块的前32位表示为: $M^{(i)}_0$, 后面32位为: $M^{(i)}_1$, 以此类推, 最后32位的消息块可表示为: $M^{(i)}_15$. 我们采用Big endian约定对数据进行编码, 即认为第一个字节是最高位字节, 因此, 对于每一个32位字节, 最最左边的比特是最大的比特位. </li>
</ul>
<h3 id="摘要计算主循环"><a href="#摘要计算主循环" class="headerlink" title="摘要计算主循环"></a>摘要计算主循环</h3><p>哈希计算算法如下:</p>
<ul>
<li><p>$For\, i = 1 \to N$ ($N$ = 补码后消息块个数)</p>
<ul>
<li><p>用第$ (i - 1)$个中间哈希值来对 $a,b,c,d,e,f,g,h$进行初始化, 当$i=1$时, 就使用初始化哈希, 即:<br>$$<br>\begin{align}<br>a&amp;\gets H^{(i-1)}_1\\<br>b&amp;\gets H^{(i-1)}_2\\<br>&amp;\vdots\\<br>h&amp;\gets H^{(i-1)}_8<br>\end{align}<br>$$</p>
</li>
<li><p>应用SHA256压缩函数来更新$a,b,…,h$</p>
<ul>
<li>$For\, j = 0 \to 63$<ul>
<li>计算$Ch(e,f,g), M_{aj}(a,b,c), \Sigma_0(a), \Sigma_1(e), W_j$(具体定义如下)<br>$$<br>\begin{align}<br>T_1 &amp;\gets h+\Sigma_1(e)+Ch(e,f,g)+K_j+W_j\\<br>T_2&amp;\gets \Sigma_0(a)+M_{aj}(a,b,c)\\<br>h&amp;\gets g\\<br>g&amp;\gets f\\<br>f&amp;\gets e\\<br>e&amp;\gets d+T_1\\<br>d&amp;\gets c\\<br>c&amp;\gets b\\<br>b&amp;\gets a\\<br>a&amp;\gets T_1+T_2<br>\end{align}<br>$$</li>
</ul>
</li>
</ul>
</li>
<li>计算第$i$个中间哈希值$H^{(i)}$<br>$$<br>\begin{align}<br>H^{(i)}_1 &amp;\gets a + H^{(i-1)}_1\\<br>H^{(i)}_2 &amp;\gets b+ H^{(i-1)}_2\\<br>&amp;\vdots\\<br>H^{(i)}_8 &amp;\gets h+H^{(i-1)}_8<br>\end{align}<br>$$</li>
</ul>
</li>
<li><p>$H^{(N)}=(H^{(N)}_1,H^{(N)}_2,…,H^{(N)}_8)$为最终需要的哈希$M$。</p>
</li>
</ul>
<h3 id="逻辑函数定义"><a href="#逻辑函数定义" class="headerlink" title="逻辑函数定义"></a>逻辑函数定义</h3><p>SHA256算法当中所使用到的6个逻辑函数如下：每个函数都对32位字节进行操纵，并输出32位字节。</p>
<p>$$<br>\begin{align}<br>Ch(x,y,z)&amp;=(x\wedge y)\oplus(\lnot x \wedge z)\\<br>M_{aj}(x,y,z)&amp;=(x\wedge y)\oplus(x\wedge z)\oplus(y\wedge z)\\<br>\Sigma_0(x)&amp;=S^2(x)\oplus S^{13}(x)\oplus S^{22}(x)\\<br>\Sigma_1(x)&amp;=S^6(x)\oplus S^{11}(x) \oplus S^{25}(x)\\<br>\sigma_0(x)&amp;=S^7(x)\oplus S^{18}(x) \oplus R^3(x)\\<br>\sigma_1(x)&amp;=S^{17}(x)\oplus S^{19}(x) \oplus R^{10}(x)<br>\end{align}<br>$$</p>
<p>扩展消息块$W_0, W_1, …, W_{63}$通过以下方式进行计算：</p>
<ul>
<li>$W_j=M^{(i)}_j \,for\,j=0,1,…,15$</li>
<li>$For \,j= 16\to 63$ <ul>
<li>$W_j\gets \sigma_1(W_{j-2})+W_{j-7}+\sigma_0(W_{j-15})+W_{j-16}$</li>
</ul>
</li>
</ul>
<h3 id="图形表示"><a href="#图形表示" class="headerlink" title="图形表示"></a>图形表示</h3><p>SHA256压缩函数的图形表示如下：</p>
<p><img src="https://machinelearning-1255641038.cos.ap-chengdu.myqcloud.com/Datacruiser_Blog_Sources/SHA/yarbrelease.dvi%202019-12-01%2017-50-06.png" alt=""></p>
<p>扩展消息块$W$的求解算法可以表示如下：</p>
<p><img src="https://machinelearning-1255641038.cos.ap-chengdu.myqcloud.com/Datacruiser_Blog_Sources/SHA/yarbrelease.dvi%202019-12-01%2017-50-41.png" alt=""></p>
<h1 id="SHA伪代码"><a href="#SHA伪代码" class="headerlink" title="SHA伪代码"></a>SHA伪代码</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">Note <span class="number">1</span>: All variables are <span class="number">32</span> bit <span class="keyword">unsigned</span> integers <span class="keyword">and</span> addition is calculated modulo <span class="number">232</span></span><br><span class="line">Note <span class="number">2</span>: For each round, there is one round constant k[i] <span class="keyword">and</span> one entry in the message schedule <span class="built_in">array</span> w[i], <span class="number">0</span> ≤ i ≤ <span class="number">63</span></span><br><span class="line">Note <span class="number">3</span>: The compression function uses <span class="number">8</span> working variables, a through h</span><br><span class="line">Note <span class="number">4</span>: Big-endian convention is used when expressing the constants in <span class="keyword">this</span> pseudocode,</span><br><span class="line">    <span class="keyword">and</span> when parsing message block data from bytes to words, <span class="keyword">for</span> example,</span><br><span class="line">    the first word of the input message <span class="string">"abc"</span> after padding is <span class="number">0x61626380</span></span><br><span class="line"></span><br><span class="line">Initialize hash values:</span><br><span class="line">(first <span class="number">32</span> bits of the fractional parts of the square roots of the first <span class="number">8</span> primes <span class="number">2.</span><span class="number">.19</span>):</span><br><span class="line">h0 := <span class="number">0x6a09e667</span></span><br><span class="line">h1 := <span class="number">0xbb67ae85</span></span><br><span class="line">h2 := <span class="number">0x3c6ef372</span></span><br><span class="line">h3 := <span class="number">0xa54ff53a</span></span><br><span class="line">h4 := <span class="number">0x510e527f</span></span><br><span class="line">h5 := <span class="number">0x9b05688c</span></span><br><span class="line">h6 := <span class="number">0x1f83d9ab</span></span><br><span class="line">h7 := <span class="number">0x5be0cd19</span></span><br><span class="line"></span><br><span class="line">Initialize <span class="built_in">array</span> of round constants:</span><br><span class="line">(first <span class="number">32</span> bits of the fractional parts of the cube roots of the first <span class="number">64</span> primes <span class="number">2.</span><span class="number">.311</span>):</span><br><span class="line">k[<span class="number">0.</span><span class="number">.63</span>] :=</span><br><span class="line">   <span class="number">0x428a2f98</span>, <span class="number">0x71374491</span>, <span class="number">0xb5c0fbcf</span>, <span class="number">0xe9b5dba5</span>, <span class="number">0x3956c25b</span>, <span class="number">0x59f111f1</span>, <span class="number">0x923f82a4</span>, <span class="number">0xab1c5ed5</span>,</span><br><span class="line">   <span class="number">0xd807aa98</span>, <span class="number">0x12835b01</span>, <span class="number">0x243185be</span>, <span class="number">0x550c7dc3</span>, <span class="number">0x72be5d74</span>, <span class="number">0x80deb1fe</span>, <span class="number">0x9bdc06a7</span>, <span class="number">0xc19bf174</span>,</span><br><span class="line">   <span class="number">0xe49b69c1</span>, <span class="number">0xefbe4786</span>, <span class="number">0x0fc19dc6</span>, <span class="number">0x240ca1cc</span>, <span class="number">0x2de92c6f</span>, <span class="number">0x4a7484aa</span>, <span class="number">0x5cb0a9dc</span>, <span class="number">0x76f988da</span>,</span><br><span class="line">   <span class="number">0x983e5152</span>, <span class="number">0xa831c66d</span>, <span class="number">0xb00327c8</span>, <span class="number">0xbf597fc7</span>, <span class="number">0xc6e00bf3</span>, <span class="number">0xd5a79147</span>, <span class="number">0x06ca6351</span>, <span class="number">0x14292967</span>,</span><br><span class="line">   <span class="number">0x27b70a85</span>, <span class="number">0x2e1b2138</span>, <span class="number">0x4d2c6dfc</span>, <span class="number">0x53380d13</span>, <span class="number">0x650a7354</span>, <span class="number">0x766a0abb</span>, <span class="number">0x81c2c92e</span>, <span class="number">0x92722c85</span>,</span><br><span class="line">   <span class="number">0xa2bfe8a1</span>, <span class="number">0xa81a664b</span>, <span class="number">0xc24b8b70</span>, <span class="number">0xc76c51a3</span>, <span class="number">0xd192e819</span>, <span class="number">0xd6990624</span>, <span class="number">0xf40e3585</span>, <span class="number">0x106aa070</span>,</span><br><span class="line">   <span class="number">0x19a4c116</span>, <span class="number">0x1e376c08</span>, <span class="number">0x2748774c</span>, <span class="number">0x34b0bcb5</span>, <span class="number">0x391c0cb3</span>, <span class="number">0x4ed8aa4a</span>, <span class="number">0x5b9cca4f</span>, <span class="number">0x682e6ff3</span>,</span><br><span class="line">   <span class="number">0x748f82ee</span>, <span class="number">0x78a5636f</span>, <span class="number">0x84c87814</span>, <span class="number">0x8cc70208</span>, <span class="number">0x90befffa</span>, <span class="number">0xa4506ceb</span>, <span class="number">0xbef9a3f7</span>, <span class="number">0xc67178f2</span></span><br><span class="line"></span><br><span class="line">Pre-processing (Padding):</span><br><span class="line">begin with the original message of length L bits</span><br><span class="line">append a single <span class="string">'1'</span> bit</span><br><span class="line">append K <span class="string">'0'</span> bits, where K is the minimum number &gt;= <span class="number">0</span> such that L + <span class="number">1</span> + K + <span class="number">64</span> is a multiple of <span class="number">512</span></span><br><span class="line">append L as a <span class="number">64</span>-bit big-endian integer, making the total post-processed length a multiple of <span class="number">512</span> bits</span><br><span class="line"></span><br><span class="line">Process the message in successive <span class="number">512</span>-bit chunks:</span><br><span class="line"><span class="keyword">break</span> message into <span class="number">512</span>-bit chunks</span><br><span class="line"><span class="keyword">for</span> each chunk</span><br><span class="line">    create a <span class="number">64</span>-entry message schedule <span class="built_in">array</span> w[<span class="number">0.</span><span class="number">.63</span>] of <span class="number">32</span>-bit words</span><br><span class="line">    (The initial values in w[<span class="number">0.</span><span class="number">.63</span>] don't matter, so many implementations zero them here)</span><br><span class="line">    copy chunk into first <span class="number">16</span> words w[<span class="number">0.</span><span class="number">.15</span>] of the message schedule <span class="built_in">array</span></span><br><span class="line"></span><br><span class="line">    Extend the first <span class="number">16</span> words into the remaining <span class="number">48</span> words w[<span class="number">16.</span><span class="number">.63</span>] of the message schedule <span class="built_in">array</span>:</span><br><span class="line">    <span class="keyword">for</span> i from <span class="number">16</span> to <span class="number">63</span></span><br><span class="line">        s0 := (w[i<span class="number">-15</span>] rightrotate  <span class="number">7</span>) xor (w[i<span class="number">-15</span>] rightrotate <span class="number">18</span>) xor (w[i<span class="number">-15</span>] rightshift  <span class="number">3</span>)</span><br><span class="line">        s1 := (w[i- <span class="number">2</span>] rightrotate <span class="number">17</span>) xor (w[i- <span class="number">2</span>] rightrotate <span class="number">19</span>) xor (w[i- <span class="number">2</span>] rightshift <span class="number">10</span>)</span><br><span class="line">        w[i] := w[i<span class="number">-16</span>] + s0 + w[i<span class="number">-7</span>] + s1</span><br><span class="line"></span><br><span class="line">    Initialize working variables to current hash value:</span><br><span class="line">    a := h0</span><br><span class="line">    b := h1</span><br><span class="line">    c := h2</span><br><span class="line">    d := h3</span><br><span class="line">    e := h4</span><br><span class="line">    f := h5</span><br><span class="line">    g := h6</span><br><span class="line">    h := h7</span><br><span class="line"></span><br><span class="line">    Compression function main loop:</span><br><span class="line">    <span class="keyword">for</span> i from <span class="number">0</span> to <span class="number">63</span></span><br><span class="line">        S1 := (e rightrotate <span class="number">6</span>) xor (e rightrotate <span class="number">11</span>) xor (e rightrotate <span class="number">25</span>)</span><br><span class="line">        ch := (e <span class="keyword">and</span> f) xor ((<span class="keyword">not</span> e) <span class="keyword">and</span> g)</span><br><span class="line">        temp1 := h + S1 + ch + k[i] + w[i]</span><br><span class="line">        S0 := (a rightrotate <span class="number">2</span>) xor (a rightrotate <span class="number">13</span>) xor (a rightrotate <span class="number">22</span>)</span><br><span class="line">        maj := (a <span class="keyword">and</span> b) xor (a <span class="keyword">and</span> c) xor (b <span class="keyword">and</span> c)</span><br><span class="line">        temp2 := S0 + maj</span><br><span class="line"> </span><br><span class="line">        h := g</span><br><span class="line">        g := f</span><br><span class="line">        f := e</span><br><span class="line">        e := d + temp1</span><br><span class="line">        d := c</span><br><span class="line">        c := b</span><br><span class="line">        b := a</span><br><span class="line">        a := temp1 + temp2</span><br><span class="line"></span><br><span class="line">    Add the compressed chunk to the current hash value:</span><br><span class="line">    h0 := h0 + a</span><br><span class="line">    h1 := h1 + b</span><br><span class="line">    h2 := h2 + c</span><br><span class="line">    h3 := h3 + d</span><br><span class="line">    h4 := h4 + e</span><br><span class="line">    h5 := h5 + f</span><br><span class="line">    h6 := h6 + g</span><br><span class="line">    h7 := h7 + h</span><br><span class="line"></span><br><span class="line">Produce the final hash value (big-endian):</span><br><span class="line">digest := hash := h0 append h1 append h2 append h3 append h4 append h5 append h6 append h7</span><br></pre></td></tr></table></figure>
<h1 id="SHA256代码实现"><a href="#SHA256代码实现" class="headerlink" title="SHA256代码实现"></a>SHA256代码实现</h1><p>下面是基于上述伪代码用<code>go</code>语言对SHA256进行的实现. </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">wikiSha256</span><span class="params">(message []<span class="keyword">byte</span>)</span> [32]<span class="title">byte</span></span> &#123;</span><br><span class="line">    <span class="comment">//初始哈希值</span></span><br><span class="line">	h0 := <span class="keyword">uint32</span>(<span class="number">0x6a09e667</span>)</span><br><span class="line">	h1 := <span class="keyword">uint32</span>(<span class="number">0xbb67ae85</span>)</span><br><span class="line">	h2 := <span class="keyword">uint32</span>(<span class="number">0x3c6ef</span>372)</span><br><span class="line">	h3 := <span class="keyword">uint32</span>(<span class="number">0xa54ff</span>53a)</span><br><span class="line">	h4 := <span class="keyword">uint32</span>(<span class="number">0x510e527f</span>)</span><br><span class="line">	h5 := <span class="keyword">uint32</span>(<span class="number">0x9b05688c</span>)</span><br><span class="line">	h6 := <span class="keyword">uint32</span>(<span class="number">0x1f83d</span>9ab)</span><br><span class="line">	h7 := <span class="keyword">uint32</span>(<span class="number">0x5be0cd</span>19)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//计算过程当中用到的常数</span></span><br><span class="line">	k := [<span class="number">64</span>]<span class="keyword">uint32</span>&#123;</span><br><span class="line">                <span class="number">0x428a2f</span>98, <span class="number">0x71374491</span>, <span class="number">0xb5c0fbcf</span>, <span class="number">0xe9b5d</span>ba5, <span class="number">0x3956c25b</span>, <span class="number">0x59f111f</span>1, <span class="number">0x923f</span>82a4, <span class="number">0xab1c5ed</span>5,</span><br><span class="line">		<span class="number">0xd807aa98</span>, <span class="number">0x12835b01</span>, <span class="number">0x243185be</span>, <span class="number">0x550c7d</span>c3, <span class="number">0x72be5d</span>74, <span class="number">0x80deb1f</span>e, <span class="number">0x9bd</span>c06a7, <span class="number">0xc19bf</span>174,</span><br><span class="line">		<span class="number">0xe49b69c1</span>, <span class="number">0xef</span>be4786, <span class="number">0x0fc19d</span>c6, <span class="number">0x240ca1cc</span>, <span class="number">0x2de92c6f</span>, <span class="number">0x4a7484aa</span>, <span class="number">0x5cb0a9d</span>c, <span class="number">0x76f988d</span>a,</span><br><span class="line">		<span class="number">0x983e5152</span>, <span class="number">0xa831c66d</span>, <span class="number">0xb00327c8</span>, <span class="number">0xbf597f</span>c7, <span class="number">0xc6e00bf</span>3, <span class="number">0xd5a79147</span>, <span class="number">0x06ca6351</span>, <span class="number">0x14292967</span>,</span><br><span class="line">		<span class="number">0x27b70a85</span>, <span class="number">0x2e1b2138</span>, <span class="number">0x4d2c6df</span>c, <span class="number">0x53380d</span>13, <span class="number">0x650a7354</span>, <span class="number">0x766a0abb</span>, <span class="number">0x81c2c92e</span>, <span class="number">0x92722c85</span>,</span><br><span class="line">		<span class="number">0xa2bf</span>e8a1, <span class="number">0xa81a664b</span>, <span class="number">0xc24b8b70</span>, <span class="number">0xc76c51a3</span>, <span class="number">0xd192e819</span>, <span class="number">0xd6990624</span>, <span class="number">0xf40e3585</span>, <span class="number">0x106aa070</span>,</span><br><span class="line">		<span class="number">0x19a4c116</span>, <span class="number">0x1e376c08</span>, <span class="number">0x2748774c</span>, <span class="number">0x34b0bcb5</span>, <span class="number">0x391c0cb3</span>, <span class="number">0x4ed</span>8aa4a, <span class="number">0x5b9cca4f</span>, <span class="number">0x682e6ff</span>3,</span><br><span class="line">		<span class="number">0x748f</span>82ee, <span class="number">0x78a5636f</span>, <span class="number">0x84c87814</span>, <span class="number">0x8cc70208</span>, <span class="number">0x90befff</span>a, <span class="number">0xa4506ceb</span>, <span class="number">0xbef9a3f</span>7, <span class="number">0xc67178f</span>2&#125;</span><br><span class="line">    </span><br><span class="line">	padded := <span class="built_in">append</span>(message, <span class="number">0x80</span>)</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(padded) % <span class="number">64</span> &lt; <span class="number">56</span> &#123;</span><br><span class="line">		suffix := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">56</span> - (<span class="built_in">len</span>(padded) % <span class="number">64</span>))</span><br><span class="line">		padded = <span class="built_in">append</span>(padded, suffix...)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		suffix := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">64</span> + <span class="number">56</span> - (<span class="built_in">len</span>(padded) % <span class="number">64</span>))</span><br><span class="line">		padded = <span class="built_in">append</span>(padded, suffix...)</span><br><span class="line">	&#125;</span><br><span class="line">	msgLen := <span class="built_in">len</span>(message) * <span class="number">8</span></span><br><span class="line">	bs := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">8</span>)</span><br><span class="line">	binary.BigEndian.PutUint64(bs, <span class="keyword">uint64</span>(msgLen))</span><br><span class="line">	padded = <span class="built_in">append</span>(padded, bs...)</span><br><span class="line"></span><br><span class="line">	broken := [][]<span class="keyword">byte</span>&#123;&#125;;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(padded) / <span class="number">64</span>; i++ &#123;</span><br><span class="line">		broken = <span class="built_in">append</span>(broken, padded[i * <span class="number">64</span>: i * <span class="number">64</span> + <span class="number">63</span>])</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//主循环</span></span><br><span class="line">	<span class="keyword">for</span> _, chunk := <span class="keyword">range</span> broken &#123;</span><br><span class="line">		w := []<span class="keyword">uint32</span>&#123;&#125;</span><br><span class="line">        </span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">16</span>; i++ &#123;</span><br><span class="line">			w = <span class="built_in">append</span>(w, binary.BigEndian.Uint32(chunk[i * <span class="number">4</span>:i * <span class="number">4</span> + <span class="number">4</span>]))</span><br><span class="line">		&#125;</span><br><span class="line">		w = <span class="built_in">append</span>(w, <span class="built_in">make</span>([]<span class="keyword">uint32</span>, <span class="number">48</span>)...)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//W消息区块处理</span></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">16</span>; i &lt; <span class="number">64</span>; i++ &#123;</span><br><span class="line">			s0 := rightRotate(w[i - <span class="number">15</span>], <span class="number">7</span>) ^ rightRotate(w[i - <span class="number">15</span>], <span class="number">18</span>) ^ (w[i - <span class="number">15</span>] &gt;&gt; <span class="number">3</span>)</span><br><span class="line">			s1 := rightRotate(w[i - <span class="number">2</span>], <span class="number">17</span>) ^ rightRotate(w[i - <span class="number">2</span>], <span class="number">19</span>) ^ (w[i - <span class="number">2</span>] &gt;&gt; <span class="number">10</span>)</span><br><span class="line">			w[i] = w[i - <span class="number">16</span>] + s0 + w[i - <span class="number">7</span>] + s1</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		a := h0</span><br><span class="line">		b := h1</span><br><span class="line">		c := h2</span><br><span class="line">		d := h3</span><br><span class="line">		e := h4</span><br><span class="line">		f := h5</span><br><span class="line">		g := h6</span><br><span class="line">		h := h7</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//应用SHA256压缩函数更新a,b,...,h</span></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">64</span>; i++ &#123;</span><br><span class="line">			S1 := rightRotate(e, <span class="number">6</span>) ^ rightRotate(e, <span class="number">11</span>) ^ rightRotate(e, <span class="number">25</span>)</span><br><span class="line">			ch := (e &amp; f) ^ ((^e) &amp; g)</span><br><span class="line">			temp1 := h + S1 + ch + k[i] + w[i]</span><br><span class="line">			S0 := rightRotate(a, <span class="number">2</span>) ^ rightRotate(a, <span class="number">13</span>) ^ rightRotate(a, <span class="number">22</span>)</span><br><span class="line">			maj := (a &amp; b) ^ (a &amp; c) ^ (b &amp; c)</span><br><span class="line">			temp2 := S0 + maj</span><br><span class="line"></span><br><span class="line">			h = g</span><br><span class="line">			g = f</span><br><span class="line">			f = e</span><br><span class="line">			e = d + temp1</span><br><span class="line">			d = c</span><br><span class="line">			c = b</span><br><span class="line">			b = a</span><br><span class="line">			a = temp1 + temp2</span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">		h0 = h0 + a</span><br><span class="line">		h1 = h1 + b</span><br><span class="line">		h2 = h2 + c</span><br><span class="line">		h3 = h3 + d</span><br><span class="line">		h4 = h4 + e</span><br><span class="line">		h5 = h5 + f</span><br><span class="line">		h6 = h6 + g</span><br><span class="line">		h7 = h7 + h</span><br><span class="line">	&#125;</span><br><span class="line">	hashBytes := [][]<span class="keyword">byte</span>&#123;iToB(h0), iToB(h1), iToB(h2), iToB(h3), iToB(h4), iToB(h5), iToB(h6), iToB(h7)&#125;</span><br><span class="line">	hash := []<span class="keyword">byte</span>&#123;&#125;</span><br><span class="line">	hashArray := [<span class="number">32</span>]<span class="keyword">byte</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">8</span>; i ++ &#123;</span><br><span class="line">		hash = <span class="built_in">append</span>(hash, hashBytes[i]...)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">copy</span>(hashArray[:], hash[<span class="number">0</span>:<span class="number">32</span>])</span><br><span class="line">	<span class="keyword">return</span> hashArray</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">iToB</span><span class="params">(i <span class="keyword">uint32</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">	bs := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">4</span>)</span><br><span class="line">	binary.BigEndian.PutUint32(bs, i)</span><br><span class="line">	<span class="keyword">return</span> bs</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//循环右移函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rightRotate</span><span class="params">(n <span class="keyword">uint32</span>, d <span class="keyword">uint</span>)</span> <span class="title">uint32</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> (n &gt;&gt; d) | (n &lt;&lt; (<span class="number">32</span> - d))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a href="https://zh.wikipedia.org/wiki/SHA-2" target="_blank" rel="noopener">SHA-2中文</a></li>
<li><a href="http://www.iwar.org.uk/comsec/resources/cipher/sha256-384-512.pdf" target="_blank" rel="noopener">Descriptions of SHA-256, SHA-384, and SHA-512</a></li>
<li><a href="https://en.wikipedia.org/wiki/SHA-2" target="_blank" rel="noopener">SHA-2英文</a></li>
</ul>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    Datacruiser
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://datacruiser.io/2019/11/22/SHA256算法原理及其实现/" title="SHA256算法原理及其实现">http://datacruiser.io/2019/11/22/SHA256算法原理及其实现/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/加密算法/" rel="tag"># 加密算法</a>
          
            <a href="/tags/比特币/" rel="tag"># 比特币</a>
          
            <a href="/tags/go语言/" rel="tag"># go语言</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/21/72-编辑距离/" rel="next" title="72. 编辑距离">
                <i class="fa fa-chevron-left"></i> 72. 编辑距离
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/12/10/区块链核心技术及应用场景演讲脚本/" rel="prev" title="区块链核心技术及其应用演讲脚本">
                区块链核心技术及其应用演讲脚本 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://i.imgur.com/qsQpBoA.jpg"
                alt="Datacruiser" />
            
              <p class="site-author-name" itemprop="name">Datacruiser</p>
              <p class="site-description motion-element" itemprop="description">Achieving what I want in light of what is true.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">159</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">121</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/datacruiser" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/realphy" target="_blank" title="Zhihu">
                    
                      <i class="fa fa-fw fa-group"></i>Zhihu</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://weibo.com/jijiwhywhy" target="_blank" title="Weibo">
                    
                      <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:phy.zju@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SHA-2-族算法简介"><span class="nav-number">1.</span> <span class="nav-text"><a href="#SHA-2-&#x65CF;&#x7B97;&#x6CD5;&#x7B80;&#x4ECB;" class="headerlink" title="SHA-2 &#x65CF;&#x7B97;&#x6CD5;&#x7B80;&#x4ECB;"></a>SHA-2 &#x65CF;&#x7B97;&#x6CD5;&#x7B80;&#x4ECB;</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SHA256原理详解"><span class="nav-number">2.</span> <span class="nav-text"><a href="#SHA256&#x539F;&#x7406;&#x8BE6;&#x89E3;" class="headerlink" title="SHA256&#x539F;&#x7406;&#x8BE6;&#x89E3;"></a>SHA256&#x539F;&#x7406;&#x8BE6;&#x89E3;</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">2.1.</span> <span class="nav-text"><a href="#&#x6982;&#x8FF0;" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#算法详细描述"><span class="nav-number">2.2.</span> <span class="nav-text"><a href="#&#x7B97;&#x6CD5;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;" class="headerlink" title="&#x7B97;&#x6CD5;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;"></a>&#x7B97;&#x6CD5;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#常量初始化"><span class="nav-number">2.2.1.</span> <span class="nav-text"><a href="#&#x5E38;&#x91CF;&#x521D;&#x59CB;&#x5316;" class="headerlink" title="&#x5E38;&#x91CF;&#x521D;&#x59CB;&#x5316;"></a>&#x5E38;&#x91CF;&#x521D;&#x59CB;&#x5316;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#消息预处理"><span class="nav-number">2.2.2.</span> <span class="nav-text"><a href="#&#x6D88;&#x606F;&#x9884;&#x5904;&#x7406;" class="headerlink" title="&#x6D88;&#x606F;&#x9884;&#x5904;&#x7406;"></a>&#x6D88;&#x606F;&#x9884;&#x5904;&#x7406;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#摘要计算主循环"><span class="nav-number">2.2.3.</span> <span class="nav-text"><a href="#&#x6458;&#x8981;&#x8BA1;&#x7B97;&#x4E3B;&#x5FAA;&#x73AF;" class="headerlink" title="&#x6458;&#x8981;&#x8BA1;&#x7B97;&#x4E3B;&#x5FAA;&#x73AF;"></a>&#x6458;&#x8981;&#x8BA1;&#x7B97;&#x4E3B;&#x5FAA;&#x73AF;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#逻辑函数定义"><span class="nav-number">2.2.4.</span> <span class="nav-text"><a href="#&#x903B;&#x8F91;&#x51FD;&#x6570;&#x5B9A;&#x4E49;" class="headerlink" title="&#x903B;&#x8F91;&#x51FD;&#x6570;&#x5B9A;&#x4E49;"></a>&#x903B;&#x8F91;&#x51FD;&#x6570;&#x5B9A;&#x4E49;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图形表示"><span class="nav-number">2.2.5.</span> <span class="nav-text"><a href="#&#x56FE;&#x5F62;&#x8868;&#x793A;" class="headerlink" title="&#x56FE;&#x5F62;&#x8868;&#x793A;"></a>&#x56FE;&#x5F62;&#x8868;&#x793A;</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SHA伪代码"><span class="nav-number">3.</span> <span class="nav-text"><a href="#SHA&#x4F2A;&#x4EE3;&#x7801;" class="headerlink" title="SHA&#x4F2A;&#x4EE3;&#x7801;"></a>SHA&#x4F2A;&#x4EE3;&#x7801;</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SHA256代码实现"><span class="nav-number">4.</span> <span class="nav-text"><a href="#SHA256&#x4EE3;&#x7801;&#x5B9E;&#x73B0;" class="headerlink" title="SHA256&#x4EE3;&#x7801;&#x5B9E;&#x73B0;"></a>SHA256&#x4EE3;&#x7801;&#x5B9E;&#x73B0;</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#参考资料"><span class="nav-number">5.</span> <span class="nav-text"><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;" class="headerlink" title="&#x53C2;&#x8003;&#x8D44;&#x6599;"></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        
<div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2020</span>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>

  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Datacruiser</span>

  
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_pv">
        本站总访问量: <span id="busuanzi_value_site_pv"></span>次
    </span>
    <span id="busuanzi_container_site_uv">
        本站访客数<span id="busuanzi_value_site_uv"></span>人次
    </span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">275.3k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  

    
      <script id="dsq-count-scr" src="https://datacruiser.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://datacruiser.io/2019/11/22/SHA256算法原理及其实现/';
          this.page.identifier = '2019/11/22/SHA256算法原理及其实现/';
          this.page.title = 'SHA256算法原理及其实现';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://datacruiser.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
